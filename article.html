<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Article — Balkan Medical Journal</title>
  <meta name="description" content="Read this article from Balkan Medical Journal.">
  <link rel="icon" href="images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="images/favicon-32x32.png" type="image/png" sizes="32x32">
  <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: { extend: { fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] } } }
    }
  </script>
  <link rel="stylesheet" href="css/custom.css">
</head>
<body class="bg-white text-gray-900 font-sans">

  <!-- Skip to Content -->
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- ══════════════════════════════════════════════════════════
       NAVIGATION
       ══════════════════════════════════════════════════════════ -->
  <nav class="bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm" aria-label="Main navigation">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-24">
        <!-- Logo -->
        <a href="index.html" class="flex items-center space-x-2 flex-shrink-0" aria-label="Balkan Medical Journal Home">
          <img src="images/logo.png" alt="Balkan Medical Journal" class="h-20 w-auto">
        </a>

        <!-- Desktop Nav -->
        <div class="hidden lg:flex items-center space-x-1">
          <a href="index.html" data-nav-page="index.html" class="px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-700 rounded-lg hover:bg-gray-50 transition-colors">Home</a>

          <!-- About Dropdown -->
          <div class="relative group">
            <button data-dropdown-trigger class="px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-700 rounded-lg hover:bg-gray-50 transition-colors inline-flex items-center">
              About
              <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
            </button>
            <div class="nav-dropdown absolute left-0 mt-1 w-52 bg-white rounded-xl shadow-lg border border-gray-100 py-2 z-50">
              <a href="about.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-teal-50 hover:text-teal-700">About the Journal</a>
              <a href="editorial-board.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-teal-50 hover:text-teal-700">Editorial Board</a>
            </div>
          </div>

          <!-- Issues & Articles Dropdown -->
          <div class="relative group">
            <button data-dropdown-trigger class="px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-700 rounded-lg hover:bg-gray-50 transition-colors inline-flex items-center">
              Issues &amp; Articles
              <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
            </button>
            <div class="nav-dropdown absolute left-0 mt-1 w-52 bg-white rounded-xl shadow-lg border border-gray-100 py-2 z-50">
              <a href="current-issue.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-teal-50 hover:text-teal-700">Current Issue</a>
              <a href="articles-in-press.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-teal-50 hover:text-teal-700">Articles in Press</a>
              <a href="archive.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-teal-50 hover:text-teal-700">Archive</a>
            </div>
          </div>

          <a href="for-authors.html" data-nav-page="for-authors.html" class="px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-700 rounded-lg hover:bg-gray-50 transition-colors">For Authors</a>
          <a href="for-reviewers.html" data-nav-page="for-reviewers.html" class="px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-700 rounded-lg hover:bg-gray-50 transition-colors">For Reviewers</a>
          <a href="policies.html" data-nav-page="policies.html" class="px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-700 rounded-lg hover:bg-gray-50 transition-colors">Policies</a>
          <a href="contact.html" data-nav-page="contact.html" class="px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-700 rounded-lg hover:bg-gray-50 transition-colors">Contact</a>
        </div>

        <!-- Submit CTA + Mobile toggle -->
        <div class="flex items-center space-x-3">
          <a href="https://balkanmedj.manuscriptmanager.net" target="_blank" rel="noopener" class="hidden sm:inline-flex items-center px-4 py-2 bg-red-700 text-white text-sm font-semibold rounded-lg hover:bg-red-800 transition-colors shadow-sm">
            Submit Manuscript
            <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
          </a>
          <button id="mobile-menu-btn" class="lg:hidden p-2 text-gray-700 hover:text-teal-700 rounded-lg hover:bg-gray-50" aria-expanded="false" aria-controls="mobile-menu" aria-label="Open menu">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Mobile Menu Overlay -->
  <div id="mobile-menu-overlay" class="hidden fixed inset-0 bg-black/50 z-50" aria-hidden="true"></div>

  <!-- Mobile Menu Panel -->
  <div id="mobile-menu" class="fixed top-0 right-0 w-80 max-w-full h-full bg-white z-50 shadow-2xl transition-menu mobile-menu-enter overflow-y-auto" role="dialog" aria-modal="true" aria-label="Mobile navigation">
    <div class="flex items-center justify-between p-4 border-b border-gray-200">
      <span class="text-lg font-bold text-teal-700">Menu</span>
      <button id="mobile-menu-close" class="p-2 text-gray-500 hover:text-gray-700 rounded-lg" aria-label="Close menu">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
      </button>
    </div>
    <div class="p-4 space-y-1">
      <a href="index.html" class="block px-4 py-3 text-gray-700 hover:bg-teal-50 hover:text-teal-700 rounded-lg font-medium">Home</a>

      <!-- About Section -->
      <button data-mobile-dropdown="mobile-about" class="w-full flex items-center justify-between px-4 py-3 text-gray-700 hover:bg-teal-50 hover:text-teal-700 rounded-lg font-medium" aria-expanded="false">
        About
        <svg class="chevron-icon w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
      </button>
      <div id="mobile-about" class="hidden pl-4 space-y-1">
        <a href="about.html" class="block px-4 py-2 text-sm text-gray-600 hover:text-teal-700 hover:bg-teal-50 rounded-lg">About the Journal</a>
        <a href="editorial-board.html" class="block px-4 py-2 text-sm text-gray-600 hover:text-teal-700 hover:bg-teal-50 rounded-lg">Editorial Board</a>
      </div>

      <!-- Issues Section -->
      <button data-mobile-dropdown="mobile-issues" class="w-full flex items-center justify-between px-4 py-3 text-gray-700 hover:bg-teal-50 hover:text-teal-700 rounded-lg font-medium" aria-expanded="false">
        Issues &amp; Articles
        <svg class="chevron-icon w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
      </button>
      <div id="mobile-issues" class="hidden pl-4 space-y-1">
        <a href="current-issue.html" class="block px-4 py-2 text-sm text-gray-600 hover:text-teal-700 hover:bg-teal-50 rounded-lg">Current Issue</a>
        <a href="articles-in-press.html" class="block px-4 py-2 text-sm text-gray-600 hover:text-teal-700 hover:bg-teal-50 rounded-lg">Articles in Press</a>
        <a href="archive.html" class="block px-4 py-2 text-sm text-gray-600 hover:text-teal-700 hover:bg-teal-50 rounded-lg">Archive</a>
      </div>

      <a href="for-authors.html" class="block px-4 py-3 text-gray-700 hover:bg-teal-50 hover:text-teal-700 rounded-lg font-medium">For Authors</a>
      <a href="for-reviewers.html" class="block px-4 py-3 text-gray-700 hover:bg-teal-50 hover:text-teal-700 rounded-lg font-medium">For Reviewers</a>
      <a href="policies.html" class="block px-4 py-3 text-gray-700 hover:bg-teal-50 hover:text-teal-700 rounded-lg font-medium">Policies</a>
      <a href="contact.html" class="block px-4 py-3 text-gray-700 hover:bg-teal-50 hover:text-teal-700 rounded-lg font-medium">Contact</a>
      <a href="news.html" class="block px-4 py-3 text-gray-700 hover:bg-teal-50 hover:text-teal-700 rounded-lg font-medium">News</a>
      <a href="forms.html" class="block px-4 py-3 text-gray-700 hover:bg-teal-50 hover:text-teal-700 rounded-lg font-medium">Forms</a>

      <div class="pt-4 border-t border-gray-200 mt-4">
        <a href="https://balkanmedj.manuscriptmanager.net" target="_blank" rel="noopener" class="flex items-center justify-center px-4 py-3 bg-red-700 text-white font-semibold rounded-lg hover:bg-red-800 transition-colors">
          Submit Manuscript
          <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
        </a>
      </div>
    </div>
  </div>

  <main id="main-content">
    <!-- Breadcrumb -->
    <div class="bg-gray-50 border-b border-gray-200">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
        <nav aria-label="Breadcrumb">
          <ol id="article-breadcrumb" class="flex items-center space-x-2 text-sm text-gray-500">
            <li><a href="index.html" class="hover:text-teal-700">Home</a></li>
            <li><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></li>
            <li><a href="current-issue.html" class="hover:text-teal-700">Current Issue</a></li>
            <li><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></li>
            <li id="breadcrumb-title" aria-current="page" class="text-gray-900 font-medium truncate max-w-xs">Article</li>
          </ol>
        </nav>
      </div>
    </div>

    <!-- Article Content (populated by JS) -->
    <div id="article-content" class="py-10">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center py-20 text-gray-400">
          <div class="spinner mx-auto mb-4" style="border-color: rgba(15,118,110,0.2); border-top-color: #0F766E; width:40px; height:40px; border-width:3px;"></div>
          <p>Loading article...</p>
        </div>
      </div>
    </div>

    <!-- Article Not Found (hidden by default) -->
    <div id="article-not-found" class="hidden py-20">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <svg class="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        <h2 class="text-2xl font-bold text-gray-900 mb-2">Article Not Found</h2>
        <p class="text-gray-500 mb-6">The article you're looking for doesn't exist or has been moved.</p>
        <a href="current-issue.html" class="inline-flex items-center px-5 py-3 bg-teal-700 text-white font-semibold rounded-lg hover:bg-teal-800 transition-colors">Browse Current Issue</a>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-teal-900 text-white" aria-label="Site footer">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        <div>
          <div class="flex items-center space-x-2 mb-4">
            <div class="w-12 h-12 rounded-lg flex items-center justify-center overflow-hidden"><img src="images/logo.png" alt="Balkan Medical Journal" class="h-12 w-12 object-contain"></div>
            <div class="font-bold text-lg">Balkan Medical Journal</div>
          </div>
          <p class="text-teal-300 text-sm leading-relaxed">Published by Trakya University, Edirne, Türkiye.<br>E-ISSN: 2146-3131</p>
        </div>
        <div><h3 class="font-semibold text-lg mb-4">Quick Links</h3><ul class="space-y-2 text-teal-300 text-sm"><li><a href="current-issue.html" class="hover:text-white transition-colors">Current Issue</a></li><li><a href="archive.html" class="hover:text-white transition-colors">Archive</a></li><li><a href="for-authors.html" class="hover:text-white transition-colors">For Authors</a></li></ul></div>
        <div><h3 class="font-semibold text-lg mb-4">About</h3><ul class="space-y-2 text-teal-300 text-sm"><li><a href="about.html" class="hover:text-white transition-colors">About the Journal</a></li><li><a href="editorial-board.html" class="hover:text-white transition-colors">Editorial Board</a></li><li><a href="policies.html" class="hover:text-white transition-colors">Policies</a></li></ul></div>
        <div><h3 class="font-semibold text-lg mb-4">Contact</h3><div class="text-teal-300 text-sm space-y-2"><p>Trakya University Faculty of Medicine<br>Edirne, Türkiye</p><p><a href="mailto:info@balkanmedicaljournal.org" class="hover:text-white transition-colors">info@balkanmedicaljournal.org</a></p></div></div>
      </div>
      <div class="border-t border-teal-800 mt-10 pt-8 text-center text-teal-400 text-sm"><p>&copy; 2025 Balkan Medical Journal. Licensed under CC BY-NC-ND 4.0</p></div>
    </div>
  </footer>

  <button id="scroll-top" class="scroll-top-btn fixed bottom-6 right-6 w-12 h-12 bg-teal-700 text-white rounded-full shadow-lg hover:bg-teal-800 transition-colors flex items-center justify-center z-40 no-print" aria-label="Scroll to top">
    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/></svg>
  </button>

  <script src="js/data/articles.js"></script>
  <script src="js/main.js"></script>
  <script src="js/citation.js"></script>
  <script>
    (function () {
      var params = new URLSearchParams(window.location.search);
      var id = parseInt(params.get('id'));
      var contentEl = document.getElementById('article-content');
      var notFoundEl = document.getElementById('article-not-found');
      var breadcrumbTitle = document.getElementById('breadcrumb-title');

      if (!id || !window.ARTICLES) {
        contentEl.classList.add('hidden');
        notFoundEl.classList.remove('hidden');
        return;
      }

      var article = window.ARTICLES.find(function (a) { return a.id === id; });
      if (!article) {
        contentEl.classList.add('hidden');
        notFoundEl.classList.remove('hidden');
        return;
      }

      // Update page title
      document.title = article.title + ' — Balkan Medical Journal';
      if (breadcrumbTitle) breadcrumbTitle.textContent = article.title;

      var typeColor = article.type === 'Review' ? 'bg-purple-100 text-purple-700' :
                      article.type === 'Editorial' ? 'bg-blue-100 text-blue-700' :
                      article.type === 'Case Report' ? 'bg-amber-100 text-amber-700' :
                      article.type === 'Brief Report' ? 'bg-cyan-100 text-cyan-700' :
                      article.type === 'Letter to the Editor' ? 'bg-pink-100 text-pink-700' :
                      article.type === 'Image Corner' ? 'bg-indigo-100 text-indigo-700' :
                      'bg-teal-100 text-teal-700';

      var pubDate = article.published ? new Date(article.published).toLocaleDateString('en-US', {year:'numeric', month:'long', day:'numeric'}) : '';
      var recDate = article.received ? new Date(article.received).toLocaleDateString('en-US', {year:'numeric', month:'long', day:'numeric'}) : '';
      var accDate = article.accepted ? new Date(article.accepted).toLocaleDateString('en-US', {year:'numeric', month:'long', day:'numeric'}) : '';

      // Authors HTML
      var authorsHtml = article.authors.map(function (a, i) {
        return '<div class="flex items-start gap-3 py-3' + (i < article.authors.length - 1 ? ' border-b border-gray-100' : '') + '">' +
          '<div class="w-10 h-10 rounded-full bg-teal-100 flex items-center justify-center flex-shrink-0"><span class="text-sm font-semibold text-teal-700">' + a.name.charAt(0) + '</span></div>' +
          '<div>' +
            '<div class="font-medium text-gray-900">' + a.name + '</div>' +
            '<div class="text-sm text-gray-500">' + a.affiliation + '</div>' +
            (a.orcid ? '<a href="https://orcid.org/' + a.orcid + '" target="_blank" rel="noopener" class="text-xs text-teal-600 hover:text-teal-700">ORCID: ' + a.orcid + '</a>' : '') +
          '</div>' +
        '</div>';
      }).join('');

      // Keywords HTML
      var keywordsHtml = (article.keywords || []).map(function (k) {
        return '<span class="inline-block px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-full">' + k + '</span>';
      }).join(' ');

      // Related articles
      var related = window.ARTICLES.filter(function (a) { return a.id !== article.id && a.type === article.type; }).slice(0, 3);
      var relatedHtml = related.map(function (r) {
        return '<a href="article.html?id=' + r.id + '" class="block p-3 rounded-lg hover:bg-gray-50 transition-colors">' +
          '<div class="text-sm font-medium text-gray-900 hover:text-teal-700 leading-snug">' + r.title + '</div>' +
          '<div class="text-xs text-gray-400 mt-1">' + r.authors[0].name + (r.authors.length > 1 ? ' et al.' : '') + '</div>' +
        '</a>';
      }).join('');

      contentEl.innerHTML =
        '<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">' +
          '<div class="grid grid-cols-1 lg:grid-cols-3 gap-10">' +
            // Main Content
            '<div class="lg:col-span-2">' +
              '<div class="mb-4 flex flex-wrap items-center gap-2">' +
                '<span class="badge ' + typeColor + '">' + article.type + '</span>' +
                '<span class="text-sm text-gray-400">Volume ' + article.volume + ', Issue ' + article.issue + ', pp. ' + article.pages + '</span>' +
              '</div>' +
              '<h1 class="text-2xl md:text-3xl font-bold text-gray-900 leading-tight mb-6">' + article.title + '</h1>' +

              // Authors summary
              '<div class="mb-6">' +
                '<p class="text-gray-600">' + article.authors.map(function(a) { return a.name; }).join(', ') + '</p>' +
              '</div>' +

              // DOI & Dates
              '<div class="bg-gray-50 rounded-xl p-4 mb-8 flex flex-wrap gap-x-6 gap-y-2 text-sm">' +
                '<div><span class="text-gray-400">DOI:</span> <a href="https://doi.org/' + article.doi + '" target="_blank" rel="noopener" class="text-teal-700 hover:underline">' + article.doi + '</a></div>' +
                (recDate ? '<div><span class="text-gray-400">Received:</span> ' + recDate + '</div>' : '') +
                (accDate ? '<div><span class="text-gray-400">Accepted:</span> ' + accDate + '</div>' : '') +
                (pubDate ? '<div><span class="text-gray-400">Published:</span> ' + pubDate + '</div>' : '') +
              '</div>' +

              // Abstract
              (article.abstract ? '<section class="mb-8"><h2 class="text-xl font-bold text-gray-900 mb-4">Abstract</h2><div class="text-gray-700 leading-relaxed prose max-w-none">' + article.abstract + '</div></section>' : '') +

              // Keywords
              (article.keywords && article.keywords.length ? '<section class="mb-8"><h2 class="text-xl font-bold text-gray-900 mb-4">Keywords</h2><div class="flex flex-wrap gap-2">' + keywordsHtml + '</div></section>' : '') +

              // Authors detail
              '<section class="mb-8"><h2 class="text-xl font-bold text-gray-900 mb-4">Authors</h2><div>' + authorsHtml + '</div></section>' +
            '</div>' +

            // Sidebar
            '<div class="lg:col-span-1 space-y-6">' +
              // Download PDF card
              '<div class="bg-gray-50 rounded-xl p-6">' +
                '<h3 class="font-semibold text-gray-900 mb-4">Access</h3>' +
                '<button onclick="showToast(\'PDF download is a demo feature\')" class="w-full flex items-center justify-center gap-2 px-4 py-3 bg-teal-700 text-white font-semibold rounded-lg hover:bg-teal-800 transition-colors mb-3">' +
                  '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>' +
                  'Download PDF' +
                '</button>' +
                '<div class="text-center text-sm text-gray-400">Open Access — Free to Read</div>' +
              '</div>' +

              // Metrics card
              '<div class="bg-gray-50 rounded-xl p-6">' +
                '<h3 class="font-semibold text-gray-900 mb-4">Metrics</h3>' +
                '<div class="space-y-3">' +
                  '<div class="flex items-center justify-between"><span class="text-sm text-gray-500">Views</span><span class="font-semibold text-gray-900">' + (article.views || 0).toLocaleString() + '</span></div>' +
                  '<div class="flex items-center justify-between"><span class="text-sm text-gray-500">Downloads</span><span class="font-semibold text-gray-900">' + (article.downloads || 0).toLocaleString() + '</span></div>' +
                  '<div class="flex items-center justify-between"><span class="text-sm text-gray-500">Citations</span><span class="font-semibold text-gray-900">' + (article.citations || 0) + '</span></div>' +
                '</div>' +
              '</div>' +

              // Citation tools
              '<div class="bg-gray-50 rounded-xl p-6">' +
                '<h3 class="font-semibold text-gray-900 mb-4">Cite This Article</h3>' +
                '<div class="space-y-2" id="citation-tools">' +
                  '<div>' +
                    '<label for="citation-format" class="text-sm text-gray-500 mb-1 block">Format</label>' +
                    '<select id="citation-format" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-teal-500 focus:border-teal-500">' +
                      '<option value="apa">APA</option>' +
                      '<option value="mla">MLA</option>' +
                      '<option value="vancouver">Vancouver</option>' +
                      '<option value="bibtex">BibTeX</option>' +
                    '</select>' +
                  '</div>' +
                  '<div id="citation-output" class="bg-white border border-gray-200 rounded-lg p-3 text-xs text-gray-700 leading-relaxed max-h-40 overflow-y-auto"></div>' +
                  '<button id="copy-citation-btn" class="w-full flex items-center justify-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors text-sm">' +
                    '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>' +
                    'Copy Citation' +
                  '</button>' +
                '</div>' +
              '</div>' +

              // Related articles
              (relatedHtml ? '<div class="bg-gray-50 rounded-xl p-6"><h3 class="font-semibold text-gray-900 mb-4">Related Articles</h3><div class="space-y-1">' + relatedHtml + '</div></div>' : '') +
            '</div>' +
          '</div>' +
        '</div>';

      // Citation tools interactivity
      var formatSelect = document.getElementById('citation-format');
      var outputEl = document.getElementById('citation-output');
      var copyBtn = document.getElementById('copy-citation-btn');

      function updateCitation() {
        var fmt = formatSelect.value;
        var text = '';
        if (fmt === 'apa') text = CitationHelper.apa(article);
        else if (fmt === 'mla') text = CitationHelper.mla(article);
        else if (fmt === 'vancouver') text = CitationHelper.vancouver(article);
        else if (fmt === 'bibtex') text = CitationHelper.bibtex(article);
        outputEl.innerHTML = fmt === 'bibtex' ? '<pre class="whitespace-pre-wrap">' + text + '</pre>' : text;
      }

      if (formatSelect) {
        formatSelect.addEventListener('change', updateCitation);
        updateCitation();
      }

      if (copyBtn) {
        copyBtn.addEventListener('click', function () {
          var fmt = formatSelect.value;
          var text = '';
          if (fmt === 'apa') text = CitationHelper.apa(article);
          else if (fmt === 'mla') text = CitationHelper.mla(article);
          else if (fmt === 'vancouver') text = CitationHelper.vancouver(article);
          else if (fmt === 'bibtex') text = CitationHelper.bibtex(article);
          CitationHelper.copyToClipboard(text);
        });
      }
    })();
  </script>
</body>
</html>
